language: r
os: linux
dist: jammy
cache: packages
r:
  - bioc-release
warnings_are_errors: true
sudo: required

before_install:
  - sudo apt-get install -y libnlopt-dev
  - sudo apt-get install -y libudunits2-dev
  - sudo apt-get install -y gdal-bin
  - sudo apt-get install -y libgdal-dev
  - sudo apt-get install -y libgeos-dev
  - sudo apt-get install -y libharfbuzz-dev
  - sudo apt-get install -y libfribidi-dev
  - sudo apt-get install -y libgit2-dev
  - sudo sudo apt-get install libcairo2-dev
  - sudo apt-get update
  - sudo apt install cmake
  - sudo apt-get install -y python3-pip
  - sudo pip3 install setuptools packaging
  - sudo pip3 install numpy scanoramaCT scanorama

r_check_args: "--as-cran"
r_packages:
  - reticulate
  - covr
  - xgboost
  -
bioc_packages:
  - limma
r_github_packages:
  - cole-trapnell-lab/monocle3
  - theislab/kBET
  - jimhester/lintr


 before_script:
  - travis_wait R -e 'install.packages("BiocManager")'
  - Rscript -e 'install.packages("leidenbase")'
  - R -e 'install.packages("reticulate")'
  - Rscript -e 'install.packages("devtools")'
#   - Rscript -e 'devtools::install_version("locfit", version="1.5-9.4")'
#   - Rscript -e 'devtools::install_github("r-spatial/sf")'
#   - Rscript -e 'devtools::install_github("cole-trapnell-lab/monocle3")'
#   - Rscript -e 'devtools::install_github("theislab/kBET")'
#   - export PKG_NAME=$(Rscript -e 'cat(paste0(devtools::as.package(".")$package))')
#   - export PKG_TARBALL=$(Rscript -e 'pkg <- devtools::as.package("."); cat(paste0(pkg$package,"_",pkg$version,".tar.gz"))')
#   - R CMD build --no-build-vignettes .
#   - R CMD INSTALL ${PKG_TARBALL}
#   - rm ${PKG_TARBALL}
#   - echo "Session info:"
#   - Rscript -e "library(${PKG_NAME});devtools::session_info('${PKG_NAME}')"
#   - Rscript -e "library(${PKG_NAME});devtools::session_info()"



after_success:
  - Rscript -e 'library(covr); codecov()'


